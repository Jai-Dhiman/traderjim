name = "mahler"
main = "src/entry.py"
compatibility_date = "2024-12-01"
compatibility_flags = ["python_workers"]

[observability]
enabled = true

# Cron triggers for scheduled workers
# Times are in UTC (ET = UTC-5 during EST, UTC-4 during EDT)
[triggers]
crons = [
    "35 14 * * MON-FRI",     # morning_scan: 9:35 AM ET (14:35 UTC during EST)
    "0 17 * * MON-FRI",      # midday_check: 12:00 PM ET (17:00 UTC during EST)
    "30 20 * * MON-FRI",     # afternoon_scan: 3:30 PM ET (20:30 UTC during EST)
    "15 21 * * MON-FRI",     # eod_summary: 4:15 PM ET (21:15 UTC during EST)
    "*/5 14-21 * * MON-FRI", # position_monitor: every 5 min during market hours
]

# D1 SQLite database for persistent storage
[[d1_databases]]
binding = "MAHLER_DB"
database_name = "mahler-db"
database_id = "b6cb2eac-2903-46bd-baea-b4ff2dc904d0"

# KV namespace for fast state (circuit breakers, rate limits)
[[kv_namespaces]]
binding = "MAHLER_KV"
id = "4e63db1305a1424ead3565522a47b5f4"

# Environment variables (non-secret)
[vars]
ENVIRONMENT = "paper"
LOG_LEVEL = "INFO"
